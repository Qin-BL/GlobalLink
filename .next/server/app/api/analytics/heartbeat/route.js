"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/analytics/heartbeat/route";
exports.ids = ["app/api/analytics/heartbeat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalytics%2Fheartbeat%2Froute&page=%2Fapi%2Fanalytics%2Fheartbeat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalytics%2Fheartbeat%2Froute.ts&appDir=%2FUsers%2FZhuanz%2FDesktop%2FCache%2Fnext-english-app-sm2%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FZhuanz%2FDesktop%2FCache%2Fnext-english-app-sm2&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalytics%2Fheartbeat%2Froute&page=%2Fapi%2Fanalytics%2Fheartbeat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalytics%2Fheartbeat%2Froute.ts&appDir=%2FUsers%2FZhuanz%2FDesktop%2FCache%2Fnext-english-app-sm2%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FZhuanz%2FDesktop%2FCache%2Fnext-english-app-sm2&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_Zhuanz_Desktop_Cache_next_english_app_sm2_app_api_analytics_heartbeat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/analytics/heartbeat/route.ts */ \"(rsc)/./app/api/analytics/heartbeat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/analytics/heartbeat/route\",\n        pathname: \"/api/analytics/heartbeat\",\n        filename: \"route\",\n        bundlePath: \"app/api/analytics/heartbeat/route\"\n    },\n    resolvedPagePath: \"/Users/Zhuanz/Desktop/Cache/next-english-app-sm2/app/api/analytics/heartbeat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_Zhuanz_Desktop_Cache_next_english_app_sm2_app_api_analytics_heartbeat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/analytics/heartbeat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhbmFseXRpY3MlMkZoZWFydGJlYXQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFuYWx5dGljcyUyRmhlYXJ0YmVhdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFuYWx5dGljcyUyRmhlYXJ0YmVhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRlpodWFueiUyRkRlc2t0b3AlMkZDYWNoZSUyRm5leHQtZW5nbGlzaC1hcHAtc20yJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRlpodWFueiUyRkRlc2t0b3AlMkZDYWNoZSUyRm5leHQtZW5nbGlzaC1hcHAtc20yJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNxQztBQUNsSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtZW5nbGlzaC1hcHAtc20yLz8yNTFhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9aaHVhbnovRGVza3RvcC9DYWNoZS9uZXh0LWVuZ2xpc2gtYXBwLXNtMi9hcHAvYXBpL2FuYWx5dGljcy9oZWFydGJlYXQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FuYWx5dGljcy9oZWFydGJlYXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hbmFseXRpY3MvaGVhcnRiZWF0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hbmFseXRpY3MvaGVhcnRiZWF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL1podWFuei9EZXNrdG9wL0NhY2hlL25leHQtZW5nbGlzaC1hcHAtc20yL2FwcC9hcGkvYW5hbHl0aWNzL2hlYXJ0YmVhdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYW5hbHl0aWNzL2hlYXJ0YmVhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalytics%2Fheartbeat%2Froute&page=%2Fapi%2Fanalytics%2Fheartbeat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalytics%2Fheartbeat%2Froute.ts&appDir=%2FUsers%2FZhuanz%2FDesktop%2FCache%2Fnext-english-app-sm2%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FZhuanz%2FDesktop%2FCache%2Fnext-english-app-sm2&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/analytics/heartbeat/route.ts":
/*!**********************************************!*\
  !*** ./app/api/analytics/heartbeat/route.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n// app/api/analytics/heartbeat/route.ts - 用户心跳监控 API\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"english-sm2-secret-key\";\n// 全局在线用户存储（实际项目中应使用 Redis）\nglobal.onlineUsers = global.onlineUsers || new Map();\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { timestamp } = body;\n        // 获取用户信息\n        const authHeader = request.headers.get(\"authorization\");\n        let userId = null;\n        if (authHeader && authHeader.startsWith(\"Bearer \")) {\n            try {\n                const token = authHeader.substring(7);\n                const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().verify(token, JWT_SECRET);\n                userId = decoded.userId;\n            } catch (error) {\n                // Token 无效，使用 sessionId\n                userId = generateSessionId(request);\n            }\n        } else {\n            // 未登录用户，使用 sessionId\n            userId = generateSessionId(request);\n        }\n        // 更新用户活跃状态\n        const currentTime = new Date().toISOString();\n        const userAgent = request.headers.get(\"user-agent\") || \"\";\n        const ipAddress = getClientIP(request);\n        // 如果没有有效的用户 ID，使用 sessionId\n        if (!userId) {\n            userId = generateSessionId(request);\n        }\n        // 获取现有用户数据或创建新的\n        const existingUser = global.onlineUsers.get(userId);\n        const userData = {\n            userId,\n            loginTime: existingUser?.loginTime || currentTime,\n            lastActivity: currentTime,\n            isActive: true,\n            sessionId: existingUser?.sessionId || generateSessionId(request),\n            userAgent,\n            ipAddress\n        };\n        // 更新在线用户数据\n        global.onlineUsers.set(userId, userData);\n        // 清理非活跃用户（超过5分钟无活动）\n        cleanupInactiveUsers();\n        // 获取当前在线用户数\n        const onlineCount = global.onlineUsers.size;\n        // 记录统计数据\n        await recordAnalytics({\n            type: \"heartbeat\",\n            userId,\n            timestamp: currentTime,\n            onlineCount,\n            sessionId: userData.sessionId\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            onlineUsers: onlineCount,\n            timestamp: currentTime,\n            sessionId: userData.sessionId\n        });\n    } catch (error) {\n        console.error(\"心跳监控 API 错误:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"心跳监控更新失败\"\n        }, {\n            status: 500\n        });\n    }\n}\n// 获取当前在线用户统计\nasync function GET(request) {\n    try {\n        // 清理非活跃用户\n        cleanupInactiveUsers();\n        const onlineCount = global.onlineUsers.size;\n        const activeUsers = Array.from(global.onlineUsers.values());\n        // 生成统计数据\n        const stats = {\n            totalOnline: onlineCount,\n            activeInLast5Min: activeUsers.filter((user)=>{\n                const lastActivity = new Date(user.lastActivity);\n                const now = new Date();\n                return now.getTime() - lastActivity.getTime() < 5 * 60 * 1000;\n            }).length,\n            peakToday: await getTodayPeakUsers(),\n            hourlyStats: await getHourlyStats()\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            stats,\n            timestamp: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"获取在线统计 API 错误:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"获取统计数据失败\"\n        }, {\n            status: 500\n        });\n    }\n}\n// 生成会话 ID\nfunction generateSessionId(request) {\n    const userAgent = request.headers.get(\"user-agent\") || \"\";\n    const ipAddress = getClientIP(request);\n    const timestamp = Date.now();\n    // 基于 IP、User-Agent 和时间戳生成唯一 ID\n    return `session_${Buffer.from(`${ipAddress}_${userAgent}_${timestamp}`).toString(\"base64\").slice(0, 16)}`;\n}\n// 获取客户端 IP 地址\nfunction getClientIP(request) {\n    const forwarded = request.headers.get(\"x-forwarded-for\");\n    const realIP = request.headers.get(\"x-real-ip\");\n    if (forwarded) {\n        return forwarded.split(\",\")[0].trim();\n    }\n    if (realIP) {\n        return realIP;\n    }\n    return request.ip || \"unknown\";\n}\n// 清理非活跃用户\nfunction cleanupInactiveUsers() {\n    const now = new Date();\n    const inactiveThreshold = 5 * 60 * 1000 // 5分钟\n    ;\n    for (const [userId, userData] of global.onlineUsers.entries()){\n        const lastActivity = new Date(userData.lastActivity);\n        if (now.getTime() - lastActivity.getTime() > inactiveThreshold) {\n            global.onlineUsers.delete(userId);\n            console.log(`清理非活跃用户: ${userId}`);\n        }\n    }\n}\n// 记录分析数据\nasync function recordAnalytics(data) {\n    try {\n        // 这里应该将数据保存到数据库\n        // 目前使用内存存储\n        global.analyticsData = global.analyticsData || [];\n        global.analyticsData.push(data);\n        // 只保留最近1000条记录\n        if (global.analyticsData.length > 1000) {\n            global.analyticsData = global.analyticsData.slice(-1000);\n        }\n    } catch (error) {\n        console.error(\"记录分析数据失败:\", error);\n    }\n}\n// 获取今天的峰值用户数\nasync function getTodayPeakUsers() {\n    try {\n        const today = new Date().toDateString();\n        const todayData = (global.analyticsData || []).filter((record)=>{\n            return new Date(record.timestamp).toDateString() === today;\n        });\n        if (todayData.length === 0) return 0;\n        return Math.max(...todayData.map((record)=>record.onlineCount || 0));\n    } catch (error) {\n        console.error(\"获取今日峰值失败:\", error);\n        return 0;\n    }\n}\n// 获取小时统计数据\nasync function getHourlyStats() {\n    try {\n        const now = new Date();\n        const hourlyStats = [];\n        // 生成过去24小时的统计\n        for(let i = 23; i >= 0; i--){\n            const hour = new Date(now.getTime() - i * 60 * 60 * 1000);\n            const hourData = (global.analyticsData || []).filter((record)=>{\n                const recordTime = new Date(record.timestamp);\n                return recordTime.getHours() === hour.getHours() && recordTime.toDateString() === hour.toDateString();\n            });\n            const avgCount = hourData.length > 0 ? Math.round(hourData.reduce((sum, record)=>sum + (record.onlineCount || 0), 0) / hourData.length) : 0;\n            hourlyStats.push({\n                hour: hour.getHours(),\n                count: avgCount\n            });\n        }\n        return hourlyStats;\n    } catch (error) {\n        console.error(\"获取小时统计失败:\", error);\n        return [];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2FuYWx5dGljcy9oZWFydGJlYXQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxvREFBb0Q7QUFDRztBQUN6QjtBQUU5QixNQUFNRSxhQUFhQyxRQUFRQyxHQUFHLENBQUNGLFVBQVUsSUFBSTtBQWE3QywyQkFBMkI7QUFDM0JHLE9BQU9DLFdBQVcsR0FBR0QsT0FBT0MsV0FBVyxJQUFJLElBQUlDO0FBRXhDLGVBQWVDLEtBQUtDLE9BQW9CO0lBQzdDLElBQUk7UUFDRixNQUFNQyxPQUFPLE1BQU1ELFFBQVFFLElBQUk7UUFDL0IsTUFBTSxFQUFFQyxTQUFTLEVBQUUsR0FBR0Y7UUFFdEIsU0FBUztRQUNULE1BQU1HLGFBQWFKLFFBQVFLLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO1FBQ3ZDLElBQUlDLFNBQXdCO1FBRTVCLElBQUlILGNBQWNBLFdBQVdJLFVBQVUsQ0FBQyxZQUFZO1lBQ2xELElBQUk7Z0JBQ0YsTUFBTUMsUUFBUUwsV0FBV00sU0FBUyxDQUFDO2dCQUNuQyxNQUFNQyxVQUFVbkIsMERBQVUsQ0FBQ2lCLE9BQU9oQjtnQkFDbENjLFNBQVNJLFFBQVFKLE1BQU07WUFDekIsRUFBRSxPQUFPTSxPQUFPO2dCQUNkLHdCQUF3QjtnQkFDeEJOLFNBQVNPLGtCQUFrQmQ7WUFDN0I7UUFDRixPQUFPO1lBQ0wscUJBQXFCO1lBQ3JCTyxTQUFTTyxrQkFBa0JkO1FBQzdCO1FBRUEsV0FBVztRQUNYLE1BQU1lLGNBQWMsSUFBSUMsT0FBT0MsV0FBVztRQUMxQyxNQUFNQyxZQUFZbEIsUUFBUUssT0FBTyxDQUFDQyxHQUFHLENBQUMsaUJBQWlCO1FBQ3ZELE1BQU1hLFlBQVlDLFlBQVlwQjtRQUU5Qiw0QkFBNEI7UUFDNUIsSUFBSSxDQUFDTyxRQUFRO1lBQ1hBLFNBQVNPLGtCQUFrQmQ7UUFDN0I7UUFFQSxnQkFBZ0I7UUFDaEIsTUFBTXFCLGVBQWV6QixPQUFPQyxXQUFXLENBQUNTLEdBQUcsQ0FBQ0M7UUFDNUMsTUFB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O0lBQ1g7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtZW5nbGlzaC1hcHAtc20yLy4vYXBwL2FwaS9hbmFseXRpY3MvaGVhcnRiZWF0L3JvdXRlLnRzPzY1ZWQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gYXBwL2FwaS9hbmFseXRpY3MvaGVhcnRiZWF0L3JvdXRlLnRzIC0g55So5oi35b+D6Lez55uR5o6nIEFQSVxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nXG5cbmNvbnN0IEpXVF9TRUNSRVQgPSBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICdlbmdsaXNoLXNtMi1zZWNyZXQta2V5J1xuXG4vLyDlnKjnur/nlKjmiLfmlbDmja7nu5PmnoRcbmludGVyZmFjZSBPbmxpbmVVc2VyIHtcbiAgdXNlcklkOiBzdHJpbmdcbiAgbG9naW5UaW1lOiBzdHJpbmdcbiAgbGFzdEFjdGl2aXR5OiBzdHJpbmdcbiAgaXNBY3RpdmU6IGJvb2xlYW5cbiAgc2Vzc2lvbklkOiBzdHJpbmdcbiAgdXNlckFnZW50Pzogc3RyaW5nXG4gIGlwQWRkcmVzcz86IHN0cmluZ1xufVxuXG4vLyDlhajlsYDlnKjnur/nlKjmiLflrZjlgqjvvIjlrp7pmYXpobnnm67kuK3lupTkvb/nlKggUmVkaXPvvIlcbmdsb2JhbC5vbmxpbmVVc2VycyA9IGdsb2JhbC5vbmxpbmVVc2VycyB8fCBuZXcgTWFwPHN0cmluZywgT25saW5lVXNlcj4oKVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IHsgdGltZXN0YW1wIH0gPSBib2R5XG5cbiAgICAvLyDojrflj5bnlKjmiLfkv6Hmga9cbiAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnYXV0aG9yaXphdGlvbicpXG4gICAgbGV0IHVzZXJJZDogc3RyaW5nIHwgbnVsbCA9IG51bGxcblxuICAgIGlmIChhdXRoSGVhZGVyICYmIGF1dGhIZWFkZXIuc3RhcnRzV2l0aCgnQmVhcmVyICcpKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3Vic3RyaW5nKDcpXG4gICAgICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKSBhcyBhbnlcbiAgICAgICAgdXNlcklkID0gZGVjb2RlZC51c2VySWRcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIFRva2VuIOaXoOaViO+8jOS9v+eUqCBzZXNzaW9uSWRcbiAgICAgICAgdXNlcklkID0gZ2VuZXJhdGVTZXNzaW9uSWQocmVxdWVzdClcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5pyq55m75b2V55So5oi377yM5L2/55SoIHNlc3Npb25JZFxuICAgICAgdXNlcklkID0gZ2VuZXJhdGVTZXNzaW9uSWQocmVxdWVzdClcbiAgICB9XG5cbiAgICAvLyDmm7TmlrDnlKjmiLfmtLvot4PnirbmgIFcbiAgICBjb25zdCBjdXJyZW50VGltZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIGNvbnN0IHVzZXJBZ2VudCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3VzZXItYWdlbnQnKSB8fCAnJ1xuICAgIGNvbnN0IGlwQWRkcmVzcyA9IGdldENsaWVudElQKHJlcXVlc3QpXG5cbiAgICAvLyDlpoLmnpzmsqHmnInmnInmlYjnmoTnlKjmiLcgSUTvvIzkvb/nlKggc2Vzc2lvbklkXG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIHVzZXJJZCA9IGdlbmVyYXRlU2Vzc2lvbklkKHJlcXVlc3QpXG4gICAgfVxuXG4gICAgLy8g6I635Y+W546w5pyJ55So5oi35pWw5o2u5oiW5Yib5bu65paw55qEXG4gICAgY29uc3QgZXhpc3RpbmdVc2VyID0gZ2xvYmFsLm9ubGluZVVzZXJzLmdldCh1c2VySWQpXG4gICAgY29uc3QgdXNlckRhdGE6IE9ubGluZVVzZXIgPSB7XG4gICAgICB1c2VySWQsXG4gICAgICBsb2dpblRpbWU6IGV4aXN0aW5nVXNlcj8ubG9naW5UaW1lIHx8IGN1cnJlbnRUaW1lLFxuICAgICAgbGFzdEFjdGl2aXR5OiBjdXJyZW50VGltZSxcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgc2Vzc2lvbklkOiBleGlzdGluZ1VzZXI/LnNlc3Npb25JZCB8fCBnZW5lcmF0ZVNlc3Npb25JZChyZXF1ZXN0KSxcbiAgICAgIHVzZXJBZ2VudCxcbiAgICAgIGlwQWRkcmVzc1xuICAgIH1cblxuICAgIC8vIOabtOaWsOWcqOe6v+eUqOaIt+aVsOaNrlxuICAgIGdsb2JhbC5vbmxpbmVVc2Vycy5zZXQodXNlcklkLCB1c2VyRGF0YSlcblxuICAgIC8vIOa4heeQhumdnua0u+i3g+eUqOaIt++8iOi2hei/hzXliIbpkp/ml6DmtLvliqjvvIlcbiAgICBjbGVhbnVwSW5hY3RpdmVVc2VycygpXG5cbiAgICAvLyDojrflj5blvZPliY3lnKjnur/nlKjmiLfmlbBcbiAgICBjb25zdCBvbmxpbmVDb3VudCA9IGdsb2JhbC5vbmxpbmVVc2Vycy5zaXplXG4gICAgXG4gICAgLy8g6K6w5b2V57uf6K6h5pWw5o2uXG4gICAgYXdhaXQgcmVjb3JkQW5hbHl0aWNzKHtcbiAgICAgIHR5cGU6ICdoZWFydGJlYXQnLFxuICAgICAgdXNlcklkLFxuICAgICAgdGltZXN0YW1wOiBjdXJyZW50VGltZSxcbiAgICAgIG9ubGluZUNvdW50LFxuICAgICAgc2Vzc2lvbklkOiB1c2VyRGF0YS5zZXNzaW9uSWRcbiAgICB9KVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBvbmxpbmVVc2Vyczogb25saW5lQ291bnQsXG4gICAgICB0aW1lc3RhbXA6IGN1cnJlbnRUaW1lLFxuICAgICAgc2Vzc2lvbklkOiB1c2VyRGF0YS5zZXNzaW9uSWRcbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign5b+D6Lez55uR5o6nIEFQSSDplJnor686JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBtZXNzYWdlOiAn5b+D6Lez55uR5o6n5pu05paw5aSx6LSlJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG5cbi8vIOiOt+WPluW9k+WJjeWcqOe6v+eUqOaIt+e7n+iuoVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIOa4heeQhumdnua0u+i3g+eUqOaIt1xuICAgIGNsZWFudXBJbmFjdGl2ZVVzZXJzKClcbiAgICBcbiAgICBjb25zdCBvbmxpbmVDb3VudCA9IGdsb2JhbC5vbmxpbmVVc2Vycy5zaXplXG4gICAgY29uc3QgYWN0aXZlVXNlcnMgPSBBcnJheS5mcm9tKGdsb2JhbC5vbmxpbmVVc2Vycy52YWx1ZXMoKSlcbiAgICBcbiAgICAvLyDnlJ/miJDnu5/orqHmlbDmja5cbiAgICBjb25zdCBzdGF0cyA9IHtcbiAgICAgIHRvdGFsT25saW5lOiBvbmxpbmVDb3VudCxcbiAgICAgIGFjdGl2ZUluTGFzdDVNaW46IGFjdGl2ZVVzZXJzLmZpbHRlcih1c2VyID0+IHtcbiAgICAgICAgY29uc3QgbGFzdEFjdGl2aXR5ID0gbmV3IERhdGUodXNlci5sYXN0QWN0aXZpdHkpXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICAgICAgcmV0dXJuIG5vdy5nZXRUaW1lKCkgLSBsYXN0QWN0aXZpdHkuZ2V0VGltZSgpIDwgNSAqIDYwICogMTAwMFxuICAgICAgfSkubGVuZ3RoLFxuICAgICAgcGVha1RvZGF5OiBhd2FpdCBnZXRUb2RheVBlYWtVc2VycygpLFxuICAgICAgaG91cmx5U3RhdHM6IGF3YWl0IGdldEhvdXJseVN0YXRzKClcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHN0YXRzLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign6I635Y+W5Zyo57q/57uf6K6hIEFQSSDplJnor686JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBtZXNzYWdlOiAn6I635Y+W57uf6K6h5pWw5o2u5aSx6LSlJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG5cbi8vIOeUn+aIkOS8muivnSBJRFxuZnVuY3Rpb24gZ2VuZXJhdGVTZXNzaW9uSWQocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBzdHJpbmcge1xuICBjb25zdCB1c2VyQWdlbnQgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd1c2VyLWFnZW50JykgfHwgJydcbiAgY29uc3QgaXBBZGRyZXNzID0gZ2V0Q2xpZW50SVAocmVxdWVzdClcbiAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKVxuICBcbiAgLy8g5Z+65LqOIElQ44CBVXNlci1BZ2VudCDlkozml7bpl7TmiLPnlJ/miJDllK/kuIAgSURcbiAgcmV0dXJuIGBzZXNzaW9uXyR7QnVmZmVyLmZyb20oYCR7aXBBZGRyZXNzfV8ke3VzZXJBZ2VudH1fJHt0aW1lc3RhbXB9YCkudG9TdHJpbmcoJ2Jhc2U2NCcpLnNsaWNlKDAsIDE2KX1gXG59XG5cbi8vIOiOt+WPluWuouaIt+erryBJUCDlnLDlnYBcbmZ1bmN0aW9uIGdldENsaWVudElQKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KTogc3RyaW5nIHtcbiAgY29uc3QgZm9yd2FyZGVkID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC1mb3J3YXJkZWQtZm9yJylcbiAgY29uc3QgcmVhbElQID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC1yZWFsLWlwJylcbiAgXG4gIGlmIChmb3J3YXJkZWQpIHtcbiAgICByZXR1cm4gZm9yd2FyZGVkLnNwbGl0KCcsJylbMF0udHJpbSgpXG4gIH1cbiAgXG4gIGlmIChyZWFsSVApIHtcbiAgICByZXR1cm4gcmVhbElQXG4gIH1cbiAgXG4gIHJldHVybiByZXF1ZXN0LmlwIHx8ICd1bmtub3duJ1xufVxuXG4vLyDmuIXnkIbpnZ7mtLvot4PnlKjmiLdcbmZ1bmN0aW9uIGNsZWFudXBJbmFjdGl2ZVVzZXJzKCkge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gIGNvbnN0IGluYWN0aXZlVGhyZXNob2xkID0gNSAqIDYwICogMTAwMCAvLyA15YiG6ZKfXG5cbiAgZm9yIChjb25zdCBbdXNlcklkLCB1c2VyRGF0YV0gb2YgZ2xvYmFsLm9ubGluZVVzZXJzLmVudHJpZXMoKSkge1xuICAgIGNvbnN0IGxhc3RBY3Rpdml0eSA9IG5ldyBEYXRlKHVzZXJEYXRhLmxhc3RBY3Rpdml0eSlcbiAgICBcbiAgICBpZiAobm93LmdldFRpbWUoKSAtIGxhc3RBY3Rpdml0eS5nZXRUaW1lKCkgPiBpbmFjdGl2ZVRocmVzaG9sZCkge1xuICAgICAgZ2xvYmFsLm9ubGluZVVzZXJzLmRlbGV0ZSh1c2VySWQpXG4gICAgICBjb25zb2xlLmxvZyhg5riF55CG6Z2e5rS76LeD55So5oi3OiAke3VzZXJJZH1gKVxuICAgIH1cbiAgfVxufVxuXG4vLyDorrDlvZXliIbmnpDmlbDmja5cbmFzeW5jIGZ1bmN0aW9uIHJlY29yZEFuYWx5dGljcyhkYXRhOiBhbnkpIHtcbiAgdHJ5IHtcbiAgICAvLyDov5nph4zlupTor6XlsIbmlbDmja7kv53lrZjliLDmlbDmja7lupNcbiAgICAvLyDnm67liY3kvb/nlKjlhoXlrZjlrZjlgqhcbiAgICBnbG9iYWwuYW5hbHl0aWNzRGF0YSA9IGdsb2JhbC5hbmFseXRpY3NEYXRhIHx8IFtdXG4gICAgZ2xvYmFsLmFuYWx5dGljc0RhdGEucHVzaChkYXRhKVxuICAgIFxuICAgIC8vIOWPquS/neeVmeacgOi/kTEwMDDmnaHorrDlvZVcbiAgICBpZiAoZ2xvYmFsLmFuYWx5dGljc0RhdGEubGVuZ3RoID4gMTAwMCkge1xuICAgICAgZ2xvYmFsLmFuYWx5dGljc0RhdGEgPSBnbG9iYWwuYW5hbHl0aWNzRGF0YS5zbGljZSgtMTAwMClcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign6K6w5b2V5YiG5p6Q5pWw5o2u5aSx6LSlOicsIGVycm9yKVxuICB9XG59XG5cbi8vIOiOt+WPluS7iuWkqeeahOWzsOWAvOeUqOaIt+aVsFxuYXN5bmMgZnVuY3Rpb24gZ2V0VG9kYXlQZWFrVXNlcnMoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9EYXRlU3RyaW5nKClcbiAgICBjb25zdCB0b2RheURhdGEgPSAoZ2xvYmFsLmFuYWx5dGljc0RhdGEgfHwgW10pLmZpbHRlcigocmVjb3JkOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiBuZXcgRGF0ZShyZWNvcmQudGltZXN0YW1wKS50b0RhdGVTdHJpbmcoKSA9PT0gdG9kYXlcbiAgICB9KVxuICAgIFxuICAgIGlmICh0b2RheURhdGEubGVuZ3RoID09PSAwKSByZXR1cm4gMFxuICAgIFxuICAgIHJldHVybiBNYXRoLm1heCguLi50b2RheURhdGEubWFwKChyZWNvcmQ6IGFueSkgPT4gcmVjb3JkLm9ubGluZUNvdW50IHx8IDApKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluS7iuaXpeWzsOWAvOWksei0pTonLCBlcnJvcilcbiAgICByZXR1cm4gMFxuICB9XG59XG5cbi8vIOiOt+WPluWwj+aXtue7n+iuoeaVsOaNrlxuYXN5bmMgZnVuY3Rpb24gZ2V0SG91cmx5U3RhdHMoKTogUHJvbWlzZTxBcnJheTx7aG91cjogbnVtYmVyLCBjb3VudDogbnVtYmVyfT4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gICAgY29uc3QgaG91cmx5U3RhdHM6IEFycmF5PHtob3VyOiBudW1iZXIsIGNvdW50OiBudW1iZXJ9PiA9IFtdXG4gICAgXG4gICAgLy8g55Sf5oiQ6L+H5Y67MjTlsI/ml7bnmoTnu5/orqFcbiAgICBmb3IgKGxldCBpID0gMjM7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBjb25zdCBob3VyID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIGkgKiA2MCAqIDYwICogMTAwMClcbiAgICAgIGNvbnN0IGhvdXJEYXRhID0gKGdsb2JhbC5hbmFseXRpY3NEYXRhIHx8IFtdKS5maWx0ZXIoKHJlY29yZDogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlY29yZFRpbWUgPSBuZXcgRGF0ZShyZWNvcmQudGltZXN0YW1wKVxuICAgICAgICByZXR1cm4gcmVjb3JkVGltZS5nZXRIb3VycygpID09PSBob3VyLmdldEhvdXJzKCkgJiZcbiAgICAgICAgICAgICAgIHJlY29yZFRpbWUudG9EYXRlU3RyaW5nKCkgPT09IGhvdXIudG9EYXRlU3RyaW5nKClcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGNvbnN0IGF2Z0NvdW50ID0gaG91ckRhdGEubGVuZ3RoID4gMCBcbiAgICAgICAgPyBNYXRoLnJvdW5kKGhvdXJEYXRhLnJlZHVjZSgoc3VtOiBudW1iZXIsIHJlY29yZDogYW55KSA9PiBzdW0gKyAocmVjb3JkLm9ubGluZUNvdW50IHx8IDApLCAwKSAvIGhvdXJEYXRhLmxlbmd0aClcbiAgICAgICAgOiAwXG4gICAgICBcbiAgICAgIGhvdXJseVN0YXRzLnB1c2goe1xuICAgICAgICBob3VyOiBob3VyLmdldEhvdXJzKCksXG4gICAgICAgIGNvdW50OiBhdmdDb3VudFxuICAgICAgfSlcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGhvdXJseVN0YXRzXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign6I635Y+W5bCP5pe257uf6K6h5aSx6LSlOicsIGVycm9yKVxuICAgIHJldHVybiBbXVxuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImp3dCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiZ2xvYmFsIiwib25saW5lVXNlcnMiLCJNYXAiLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwidGltZXN0YW1wIiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJnZXQiLCJ1c2VySWQiLCJzdGFydHNXaXRoIiwidG9rZW4iLCJzdWJzdHJpbmciLCJkZWNvZGVkIiwidmVyaWZ5IiwiZXJyb3IiLCJnZW5lcmF0ZVNlc3Npb25JZCIsImN1cnJlbnRUaW1lIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidXNlckFnZW50IiwiaXBBZGRyZXNzIiwiZ2V0Q2xpZW50SVAiLCJleGlzdGluZ1VzZXIiLCJ1c2VyRGF0YSIsImxvZ2luVGltZSIsImxhc3RBY3Rpdml0eSIsImlzQWN0aXZlIiwic2Vzc2lvbklkIiwic2V0IiwiY2xlYW51cEluYWN0aXZlVXNlcnMiLCJvbmxpbmVDb3VudCIsInNpemUiLCJyZWNvcmRBbmFseXRpY3MiLCJ0eXBlIiwic3VjY2VzcyIsImNvbnNvbGUiLCJtZXNzYWdlIiwic3RhdHVzIiwiR0VUIiwiYWN0aXZlVXNlcnMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJzdGF0cyIsInRvdGFsT25saW5lIiwiYWN0aXZlSW5MYXN0NU1pbiIsImZpbHRlciIsInVzZXIiLCJub3ciLCJnZXRUaW1lIiwibGVuZ3RoIiwicGVha1RvZGF5IiwiZ2V0VG9kYXlQZWFrVXNlcnMiLCJob3VybHlTdGF0cyIsImdldEhvdXJseVN0YXRzIiwiQnVmZmVyIiwidG9TdHJpbmciLCJzbGljZSIsImZvcndhcmRlZCIsInJlYWxJUCIsInNwbGl0IiwidHJpbSIsImlwIiwiaW5hY3RpdmVUaHJlc2hvbGQiLCJlbnRyaWVzIiwiZGVsZXRlIiwibG9nIiwiZGF0YSIsImFuYWx5dGljc0RhdGEiLCJwdXNoIiwidG9kYXkiLCJ0b0RhdGVTdHJpbmciLCJ0b2RheURhdGEiLCJyZWNvcmQiLCJNYXRoIiwibWF4IiwibWFwIiwiaSIsImhvdXIiLCJob3VyRGF0YSIsInJlY29yZFRpbWUiLCJnZXRIb3VycyIsImF2Z0NvdW50Iiwicm91bmQiLCJyZWR1Y2UiLCJzdW0iLCJjb3VudCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/analytics/heartbeat/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/semver","vendor-chunks/jsonwebtoken","vendor-chunks/jws","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/safe-buffer","vendor-chunks/ms","vendor-chunks/lodash.once","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isplainobject","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isinteger","vendor-chunks/lodash.isboolean","vendor-chunks/lodash.includes","vendor-chunks/jwa","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalytics%2Fheartbeat%2Froute&page=%2Fapi%2Fanalytics%2Fheartbeat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalytics%2Fheartbeat%2Froute.ts&appDir=%2FUsers%2FZhuanz%2FDesktop%2FCache%2Fnext-english-app-sm2%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FZhuanz%2FDesktop%2FCache%2Fnext-english-app-sm2&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();